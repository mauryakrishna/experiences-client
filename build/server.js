/*! For license information please see server.js.LICENSE.txt */
require("source-map-support").install(),module.exports=(()=>{var e,t,r,o={8692:(e,t,r)=>{"use strict";r.d(t,{EG:()=>o,Un:()=>n,wF:()=>i,Ce:()=>s,j1:()=>a,Nr:()=>l,SW:()=>c,ni:()=>u,xr:()=>p});const o="/editor",n=3e3,i=2e3,s=1,a=2,l=3,c=4,u=200,p=160},900:e=>{e.exports={port:process.env.PORT,appURL:process.env.APP_URL,trustProxy:process.env.TRUST_PROXY,api:{clientUrl:process.env.API_CLIENT_URL,serverUrl:process.env.API_SERVER_URL},analytics:{googleTrackingId:process.env.GOOGLE_TRACKING_ID},auth:{jwt:{secret:process.env.JWT_SECRET},facebook:{id:process.env.FACEBOOK_APP_ID||"3083254791728201",secret:process.env.FACEBOOK_APP_SECRET||"47e2cda6d0287b6f9fa074b66a20e67e"},google:{id:process.env.GOOGLE_CLIENT_ID||"251410730550-ahcg0ou5mgfhl8hlui1urru7jn5s12km.apps.googleusercontent.com",secret:process.env.GOOGLE_CLIENT_SECRET||"Y8yR9yZAhm9jQ8FKAL8QIEcd"},twitter:{key:process.env.TWITTER_CONSUMER_KEY||"Ie20AZvLJI2lQD5Dsgxgjauns",secret:process.env.TWITTER_CONSUMER_SECRET||"KTZ6cxoKnEakQCeSpZlaUCJWGAlTEBJj0y2EMkUBujA7zWSvaQ"}}}},7808:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Le});const o=require("path");var n=r.n(o);const i=require("express");var s=r.n(i);const a=require("cookie-parser");var l=r.n(a);const c=require("body-parser");var u=r.n(c);const p=require("node-fetch");var d=r.n(p),f=r(9297),h=r.n(f);const g=require("react-dom/server");var m=r.n(g);const v=require("@loadable/server"),y=require("pretty-error");var x=r.n(y);const b=require("express-http-proxy");var k=r.n(b);const S=require("node-localstorage"),_=require("@apollo/react-ssr");var q=r(9691);const E=require("apollo-client"),w=require("apollo-cache-inmemory"),T=require("apollo-link-http"),j=require("apollo-link-error"),P=require("apollo-link-context");var C=r(900),I=r.n(C);r(4229);const O=require("isomorphic-style-loader/StyleContext");var A=r.n(O);const R=h().createContext({fetch:()=>{throw new Error("Fetch method not initialized.")}});var L;function U(e,t,r,o){L||(L="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var n=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var s=new Array(i),a=0;a<i;a++)s[a]=arguments[a+3];t.children=s}if(t&&n)for(var l in n)void 0===t[l]&&(t[l]=n[l]);else t||(t=n||{});return{$$typeof:L,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}function $({context:e,insertCss:t,children:r}){return U(A().Provider,{value:{insertCss:t}},void 0,U(R.Provider,{value:{context:e}},void 0,h().Children.only(r)))}const M=require("serialize-javascript");var N,F=r.n(M);function G(e,t,r,o){N||(N="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var n=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var s=new Array(i),a=0;a<i;a++)s[a]=arguments[a+3];t.children=s}if(t&&n)for(var l in n)void 0===t[l]&&(t[l]=n[l]);else t||(t=n||{});return{$$typeof:N,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}var B=G("meta",{charSet:"utf-8"}),D=G("meta",{httpEquiv:"x-ua-compatible",content:"ie=edge"}),J=G("meta",{name:"google-site-verification",content:"UZYrsB1BXHH_HQD8QpPlyJJZZYUCVPIOrkO4XLXhqII"}),Q=G("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),H=G("meta",{name:"robots",content:"index/follow"}),z=G("link",{rel:"apple-touch-icon",sizes:"180x180",href:"/apple-touch-icon.png"}),K=G("link",{rel:"apple-touch-icon",href:"/favicon.png"}),W=G("link",{rel:"icon",type:"image/png",sizes:"32x32",href:"/favicon-32x32.png"}),Z=G("link",{rel:"icon",type:"image/png",sizes:"16x16",href:"/favicon-16x16.png"}),Y=G("link",{rel:"manifest",href:"/site.webmanifest"}),X=G("script",{},void 0,"global = window.globalThis"),V=G("script",{async:!0,defer:!0,"data-domain":"experiences.guru",src:"https://experiences.guru/js/plausible.js"});function ee({title:e,description:t,styles:r,scripts:o,app:n,state:i,children:s}){return G("html",{className:"no-js",lang:"en"},void 0,G("head",{},void 0,B,D,J,Q,H,o.map((e=>G("link",{rel:"preload",href:e,as:"script"},e))),z,K,W,Z,Y,r.map((e=>G("style",{id:e.id,dangerouslySetInnerHTML:{__html:e.cssText}},e.id))),X,V),G("body",{},void 0,G("div",{id:"app",dangerouslySetInnerHTML:{__html:s}}),G("script",{dangerouslySetInnerHTML:{__html:`window.__APOLLO_STATE__=${F()(i)}`}}),G("script",{dangerouslySetInnerHTML:{__html:`window.App=${F()(n)}`}}),o.map((e=>G("script",{src:e},e)))))}ee.defaultProps={styles:[],scripts:[]},r(1226);var te,re=r(7248),oe=r.n(re);function ne(e,t,r,o){te||(te="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var n=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var s=new Array(i),a=0;a<i;a++)s[a]=arguments[a+3];t.children=s}if(t&&n)for(var l in n)void 0===t[l]&&(t[l]=n[l]);else t||(t=n||{});return{$$typeof:te,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}var ie=ne("h1",{},void 0,"Error"),se=ne("p",{},void 0,"Sorry, a critical error occurred on this page.");function ae({error:e}){return h().createElement(h().Fragment,null,ie,se)}ae.defaultProps={error:null};const le=require("passport");var ce=r.n(le);const ue=require("passport-facebook"),pe={clientID:I().auth.facebook.id,clientSecret:I().auth.facebook.secret,callbackURL:"/auth/facebook/return",profileFields:["id","email","displayName"],passReqToCallback:!0},de=new ue.Strategy(pe,(async(e,t,r,o,n)=>{const{exist:i,author:s}=await(async e=>{const t=localStorage.getItem("authIntent"),{name:r,email:o}=e._json;let n,i;"login"===t?(n="\n      query signinAuthor($email: String!) {\n        signinAuthor(email: $email) {\n          exist\n          author {\n            displayname\n            authoruid\n          }\n        }\n      }\n    ",i={email:o}):"register"===t&&(n="\n      mutation signupAuthor($input: SignupAuthorInput) {\n        signupAuthor(input: $input) {\n          exist\n          author {\n            displayname\n            authoruid\n          }\n        }\n      }\n    ",i={input:{displayname:r,email:o}});const{data:s}=await fetch(I().api.serverUrl,{method:"POST",Accept:"application/json",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:n,variables:i})}).then((e=>e.json())),{exist:a,author:l}=s.signinAuthor||s.signupAuthor;return{exist:a,author:l}})(o);e.exist=i,e.author=s,e.profilejson=o._json,n(null,e)}));ce().use(de);const fe=require("jsonwebtoken");var he=r.n(fe);const ge=s().Router(),me=e=>localStorage.setItem("authIntent",e),ve=(e,t,r)=>{me("login"),r()},ye=(e,t,r)=>{me("register"),r()},xe=(e,t)=>{const{exist:r,profilejson:o,author:n}=e,i=localStorage.getItem("authIntent");let s=null;s=!1===r?{displayname:o.name,email:o.email}:n;const a=he().sign(s,I().auth.jwt.secret,{expiresIn:604800});t.cookie("id_token",a,{maxAge:6048e5,httpOnly:!0,sameSite:"Strict"}),"login"===i&&!1===r?t.redirect("/register"):t.redirect("/")};ge.get("/logout",((e,t)=>{t.clearCookie("id_token"),t.redirect("/")})),ge.get("/login/facebook",ve,ce().authenticate("facebook",{scope:["email","user_location"],session:!1})),ge.get("/register/facebook",ye,ce().authenticate("facebook",{scope:["email","user_location"],session:!1})),ge.get("/auth/facebook/return",ce().authenticate("facebook",{failureRedirect:"/login",session:!1}),xe),ge.get("/login/google",ve,ce().authenticate("google",{scope:["email","profile"],session:!1})),ge.get("/register/google",ye,ce().authenticate("google",{scope:["email","profile"],session:!1})),ge.get("/auth/google/return",ce().authenticate("google",{failureRedirect:"/login",session:!1}),xe);const be=require("universal-router");var ke=r.n(be),Se=r(7470),_e=r.n(Se);const qe={path:"",children:[{path:"",load:()=>Promise.all([r.e(675),r.e(177)]).then(r.bind(r,5337))},{path:`${r(8692).EG}`,load:()=>Promise.all([r.e(675),r.e(353)]).then(r.bind(r,5814))},{path:"/author/:authoruid",load:()=>Promise.all([r.e(675),r.e(741)]).then(r.bind(r,9786))},{path:"/edit/:slugkey",protected:!0,load:()=>Promise.all([r.e(675),r.e(353)]).then(r.bind(r,5814))},{path:"/reset-password/:requestkey",load:()=>Promise.all([r.e(675),r.e(564)]).then(r.bind(r,6055))},{path:"/verify/:verifykey",load:()=>Promise.all([r.e(675),r.e(306)]).then(r.bind(r,1916))},{path:"/:authoruid/:slug",load:()=>Promise.all([r.e(675),r.e(69)]).then(r.bind(r,4747))},{path:"(.*)",name:"not-found",load:()=>Promise.all([r.e(675),r.e(942)]).then(r.bind(r,9686))}],async action({next:e}){const t=await e();return t.title=`${t.title||"World of experiences"}`,t}},Ee=new(ke())(qe,{resolveRoute(e,t){const r=_e().get("loggedin");return e.route.protected&&!r?{redirect:"/",from:e.pathname}:"function"==typeof e.route.load?e.route.load().then((r=>r.default(e,t))):"function"==typeof e.route.action?e.route.action(e,t):void 0}}),we=require("./chunk-manifest.json");var Te,je=r.n(we);function Pe(){return(Pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e}).apply(this,arguments)}function Ce(e,t,r,o){Te||(Te="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var n=e&&e.defaultProps,i=arguments.length-3;if(t||0===i||(t={children:void 0}),1===i)t.children=o;else if(i>1){for(var s=new Array(i),a=0;a<i;a++)s[a]=arguments[a+3];t.children=s}if(t&&n)for(var l in n)void 0===t[l]&&(t[l]=n[l]);else t||(t=n||{});return{$$typeof:Te,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}process.on("unhandledRejection",((e,t)=>{console.error("Unhandled Rejection at:",t,"reason:",e),process.exit(1)})),global.navigator=global.navigator||{},global.navigator.userAgent=global.navigator.userAgent||"all",global.localStorage=new S.LocalStorage("./scratch");const Ie=s()();global.fetch=d(),Ie.set("trust proxy",I().trustProxy),Ie.use(s().static(n().resolve(__dirname,"public"))),Ie.use(l()()),Ie.use(u().urlencoded({extended:!0})),Ie.use(u().json());const Oe=n().resolve("./build/loadable-stats.json"),Ae=new v.ChunkExtractor({statsFile:Oe});Ie.post("/gql",k()(I().api.serverUrl)),Ie.get("*",(async(e,t,r)=>{try{const r=new Set,o=(...e)=>{e.forEach((e=>r.add(e._getCss())))},n={fetch,pathname:e.path,query:e.query},i=await Ee.resolve(n);if(i.redirect)return void t.redirect(i.status||302,i.redirect);const s={...i},a=(e=>{const t=(0,T.createHttpLink)({uri:I().api.serverUrl,credentials:"include",headers:{cookie:e.header("Cookie")},fetchPolicy:"network-only",errorPolicy:"all"}),r=(0,P.setContext)(((e,{headers:t})=>({headers:{...t}}))),o=(0,j.onError)((({graphQLErrors:e,networkError:t})=>{e&&e.map((({message:e,locations:t,path:r})=>console.log(`[GraphQL error]: Message: ${e}, Location: ${t}, Path: ${r}`))),t&&console.log(`[Network error]: ${t}`)}));return new E.ApolloClient({ssrMode:!0,link:Array.from([o,r,t]),ssrForceFetchDelay:100,cache:new w.InMemoryCache,resolvers:{}})})(e);(0,_.getDataFromTree)($).then((()=>{const e=m().renderToString(Ce(v.ChunkExtractorManager,{extractor:Ae},void 0,Ce(q.ApolloProvider,{client:a},void 0,Ce($,{context:n,insertCss:o},void 0,i.component)))),l=a.extract();s.children=e,s.styles=[{id:"css",cssText:[...r].join("")}];const c=new Set,u=e=>{je()[e]&&je()[e].forEach((e=>c.add(e)))};u("client"),i.chunk&&u(i.chunk),i.chunks&&i.chunks.forEach(u),s.scripts=Array.from(c),s.app={apiUrl:I().api.clientUrl};const p=m().renderToStaticMarkup(h().createElement(ee,Pe({},s,{state:l})));t.status(i.status||200),t.send(`<!doctype html>${p}`)}))}catch(e){r(e)}}));const Re=new(x());Re.skipNodeFiles(),Re.skipPackage("express"),Ie.use(((e,t,r,o)=>{console.error(Re.render(e));const n=m().renderToStaticMarkup(Ce(ee,{title:"Internal Server Error",styles:[{id:"css",cssText:oe()._getCss()}]},void 0,m().renderToString(Ce(ae,{error:e}))));r.status(e.status||500),r.send(`<!doctype html>${n}`)})),Ie.listen(I().port,(()=>{console.info(`The server is running at ${I().appURL}:${I().port}`)}));const Le=Ie},9938:(e,t,r)=>{(t=r(3645)(!1)).push([e.id,"html{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;padding:0 2rem;height:100%;font-family:sans-serif;text-align:center;color:#888}body{margin:0}h1{font-weight:400;color:#555}pre{white-space:pre-wrap;text-align:left}",""]),e.exports=t},3645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r,o,n,i=e[1]||"",s=e[3];if(!s)return i;if(t&&"function"==typeof btoa){var a=(r=s,o=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(n," */")),l=s.sources.map((function(e){return"/*# sourceURL=".concat(s.sourceRoot||"").concat(e," */")}));return[i].concat(l).concat([a]).join("\n")}return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r})).join("")},t.i=function(e,r,o){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(o)for(var i=0;i<this.length;i++){var s=this[i][0];null!=s&&(n[s]=!0)}for(var a=0;a<e.length;a++){var l=[].concat(e[a]);o&&n[l[0]]||(r&&(l[2]?l[2]="".concat(r," and ").concat(l[2]):l[2]=r),t.push(l))}},t}},7248:(e,t,r)=>{var o=r(9938),n=r(4718),i="string"==typeof o?[[e.id,o,""]]:o;(t=e.exports=o.locals||{})._getContent=function(){return i},t._getCss=function(){return""+o},t._insertCss=function(e){return n(i,e)}},4718:e=>{"use strict";var t={};function r(e){e.forEach((function(e){if(--t[e]<=0){var r=document.getElementById(e);r&&r.parentNode.removeChild(r)}}))}e.exports=function(e,o){for(var n,i=void 0===o?{}:o,s=i.replace,a=void 0!==s&&s,l=i.prepend,c=void 0!==l&&l,u=i.prefix,p=void 0===u?"s":u,d=[],f=0;f<e.length;f++){var h=e[f],g=h[0],m=h[1],v=h[2],y=h[3],x=""+p+g+"-"+f;if(d.push(x),!t[x]||a){t[x]=1;var b=document.getElementById(x),k=!1;b||(k=!0,(b=document.createElement("style")).setAttribute("type","text/css"),b.id=x,v&&b.setAttribute("media",v));var S=m;y&&"function"==typeof btoa&&(S+="\n/*# sourceMappingURL=data:application/json;base64,"+(n=JSON.stringify(y),btoa(encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)})))+"*/"),S+="\n/*# sourceURL="+y.file+"?"+x+"*/"),"textContent"in b?b.textContent=S:b.styleSheet.cssText=S,k&&(c?document.head.insertBefore(b,document.head.childNodes[0]):document.head.appendChild(b))}else t[x]++}return r.bind(null,d)}},6949:e=>{"use strict";e.exports=require("@babel/polyfill")},2668:e=>{"use strict";e.exports=require("@chakra-ui/core")},3279:e=>{"use strict";e.exports=require("@loadable/component")},6161:e=>{"use strict";e.exports=require("@styled-icons/material")},8262:e=>{"use strict";e.exports=require("@udecode/slate-plugins")},7819:e=>{"use strict";e.exports=require("date-and-time")},9875:e=>{"use strict";e.exports=require("graphql-tag")},6982:e=>{"use strict";e.exports=require("history")},1226:e=>{"use strict";e.exports=require("isomorphic-style-loader/useStyles")},7470:e=>{"use strict";e.exports=require("local-storage")},6414:e=>{"use strict";e.exports=require("lodash/isEqual")},4229:e=>{"use strict";e.exports=require("prop-types")},9297:e=>{"use strict";e.exports=require("react")},9691:e=>{"use strict";e.exports=require("react-apollo-hooks")},6481:e=>{"use strict";e.exports=require("react-helmet")},3556:e=>{"use strict";e.exports=require("react-textarea-autosize")},560:e=>{"use strict";e.exports=require("slate")},1641:e=>{"use strict";e.exports=require("slate-history")},4684:e=>{"use strict";e.exports=require("slate-react")},9299:e=>{"use strict";e.exports=require("use-debounce")}},n={};function i(e){if(n[e])return n[e].exports;var t=n[e]={id:e,exports:{}};return o[e](t,t.exports,i),t.exports}return i.m=o,i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(r,o){if(1&o&&(r=this(r)),8&o)return r;if("object"==typeof r&&r){if(4&o&&r.__esModule)return r;if(16&o&&"function"==typeof r.then)return r}var n=Object.create(null);i.r(n);var s={};e=e||[null,t({}),t([]),t(t)];for(var a=2&o&&r;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>s[e]=()=>r[e]));return s.default=()=>r,i.d(n,s),n},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,r)=>(i.f[r](e,t),t)),[])),i.u=e=>"chunks/"+({41:"UIElements-MobileNotSupported",69:"read-experience",148:"Authenticate",177:"home",196:"Editor",306:"verify-email",312:"ExpressThoughts",353:"write-editor",438:"Login",482:"GetStartedButton",494:"Register",564:"reset-password",585:"Thoughts",683:"ReadThoughts",722:"UIElements-InspireText",741:"allofauthor",747:"components-Inspire",942:"not-found"}[e]||e)+".js",i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r={377:1},i.f.require=function(e,t){r[e]||(e=>{var t=e.modules,o=e.ids,n=e.runtime;for(var s in t)i.o(t,s)&&(i.m[s]=t[s]);n&&n(i);for(var a=0;a<o.length;a++)r[o[a]]=1})(require("./"+i.u(e)))},i(6949),i(7808)})();